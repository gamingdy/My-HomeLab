---
import {Code} from "@astrojs/starlight/components";

const GITHUB_BASE_URL: string = "https://raw.githubusercontent.com/gamingdy/My-HomeLab/refs/heads/main/";

// Props for the component
let {url, title, language, mark, isGithub} = Astro.props;

if (!url) {
    throw new Error("URL is required to fetch data.");
}

if (isGithub) {
    url = `${GITHUB_BASE_URL}/${url}`;
}

// Fetch data during server-side rendering
let data = "";
try {
    const response = await fetch(url);
    if (!response.ok) {
        throw new Error(`Failed to fetch data: ${response.statusText}`);
    }
    data = await response.text();
} catch (error) {
    console.error(error);
}
---

<!-- Component rendering -->
<Code code={data} lang={language} title={title} mark={mark}/>
